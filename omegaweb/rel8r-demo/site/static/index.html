<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>Rel8r Demo: gtd-plus</title>
    <link rel="stylesheet" type="text/css" href="/styles/main.css" />
    <!-- <script type="text/javascript" src="/scripts/jquery-1.11.0.min.js"></script> -->
    <script type="text/javascript" src="/scripts/jquery-1.11.0.js"></script>
 	  <script type="text/javascript" src="/scripts/jquery-ui-1.10.4/ui/jquery.ui.core.js"></script>
 	  <script type="text/javascript" src="/scripts/jquery-ui-1.10.4/ui/jquery.ui.widget.js"></script>
    <script type="text/javascript" src="/scripts/jquery-ui-1.10.4/ui/jquery.ui.button.js"></script>
 	  <script type="text/javascript" src="/scripts/jquery-ui-1.10.4/ui/jquery.ui.mouse.js"></script>
 	  <script type="text/javascript" src="/scripts/jquery-ui-1.10.4/ui/jquery.ui.draggable.js"></script>
 	  <script type="text/javascript" src="/scripts/jquery-ui-1.10.4/ui/jquery.ui.position.js"></script>
 	  <script type="text/javascript" src="/scripts/jquery-ui-1.10.4/ui/jquery.ui.resizable.js"></script>
 	  <script type="text/javascript" src="/scripts/jquery-ui-1.10.4/ui/jquery.ui.dialog.js"></script>
    <script type="text/javascript">
      var display_specs = {
        "project": {
          "label": "title"
        },
        "action": {
          "label": "content"
        },
        "person": {
          "label": "given-name & surname"
        },
        "email-address": {
          "label": "label"
        }
      };
      var items = {};

      function loadItem(item, replace) {
        var item_id = item["%ID"];
        if ( items.hasOwnProperty(item_id) && !replace ) {
          throw ("Item '" + item_id + "' already exists.");
        }
        items[item_id] = item;
      }
      function unloadItem(item_id) {
        delete items[item_id];
      }
      function getItemByID(id) {
        var matched = items.filter(function(item) {
          return item["%ID"] === id;
        });
        switch ( matched.length ) {
          case 0:
            return null;
          case 1:
            return matched[0];
          default:
            throw "Error: duplicate item IDs";
        }
      }
      function getItemsByType(type) {
        var result = [];
        for (var i in items) {
          var item = items[i];
          if (item["%TYPE"] === type) {
            result.push(item);
          }
        }
        return result;
      }
      function isArray(value) {
        return value &&
          typeof value === 'object' &&
          value.constructor === Array;
      }
      function getLabel(item, item_type) {
        var label = "";
        var label_spec = display_specs[item_type]["label"];
        var segments = label_spec.split("&");
        for (var i = 0; i < segments.length; i++) {
          var segment = item[segments[i].trim()];
          label += (" " + segment);
        }
        return label.trim();
      }

      function showItemBox(item, item_type, parent_sel, is_subitem) {
        var klass;
        if ( is_subitem ) {
          klass = "SubItemBox";
        } else {
          klass = "ItemBox";
        }
        var label = getLabel(item, item_type); 
        var box_id = item_type + "-" + item["%ID"] + "-box"; 
        var item_box = $( "<div></div>" );
        $( parent_sel ).append( item_box );
        $( item_box ).addClass( klass );
        $( item_box ).attr("id", box_id);
        $( item_box ).append( "<h3 class='ItemLabel'>" + label + "</h3>" );
        return item_box;
      }
      function addOneLineField(container, label, data) {
        $( "<div></div>" ).appendTo( container )
          .append("<span class='FieldLabel'>" + label + ": </span>")
          .append("<span class='FieldValue'>" + data + "</span>");
      }
      function addMultiLineField(container, label, data) {
        var field_div = $( "<div></div>" ).appendTo( container )
          .append("<p class='FieldLabel'>" + label + ": </p>");
        if ( isArray(data) ) {
          for ( var i = 0; i < data.length; i++ ) {
            $( field_div ).append("<div class='FieldValue'>" + data[i] + "</div>");
          }
        } else {
          $( field_div ).append("<div class='FieldValue'>" + data + "</div>");
        }
      }
      function addMultiItemField(container, label, data) {
        var field_div = $( "<div></div>" ).appendTo( container )
          .append("<span class='FieldLabel'>" + label + ": </span>");
        var value_span = $( "<span class='FieldValue'></span>" );
        $( value_span ).appendTo( field_div );
        if ( isArray(data) ) {
          for ( var i = 0; i < data.length; i++ ) {
            var txt = $( value_span ).text(); 
            if ( txt === "" ) { 
              txt = data[i];
            } else {
              txt += ", " + data[i];
            }
            $( value_span ).text(txt);
          }
        } else {
          $( value_span ).text( data );
        }
      }
      function showProjectBox(item, parent_sel) {
        if ( parent_sel === undefined ) {
          parent_sel = "#projectSpace";
        }
        var item_box = showItemBox( item, "project", parent_sel );
        if ( item.hasOwnProperty("description") ) {
          $( item_box ).append("<p class='ItemDescription'>" + item.description + "</p>");
        }
        if ( item.hasOwnProperty("deadline") ) {
          addOneLineField( item_box, "Deadline", item.deadline );
        }
        if ( item.hasOwnProperty("contacts") ) {
          addMultiLineField( item_box, "Contacts", item.contacts );
        }
        if ( item.hasOwnProperty("steps") ) {
          addMultiLineField( item_box, "Steps", item.steps );
        }
      }
      function showActionBox(item, parent_sel) {
        if ( parent_sel === undefined ) {
          parent_sel = "#toDoSpace";
        }
        var item_box = showItemBox( item, "action", parent_sel );
        if ( item.hasOwnProperty("context") ) {
          addMultiItemField( item_box, "Context", item.context );
        }
      }
      function showEventBox(item, parent_sel) {
        if ( parent_sel === undefined ) {
          parent_sel = "#calendarSpace";
        }
        var item_box = showItemBox( item, "event", parent_sel );
      }
      function showAppointmentBox(item, parent_sel) {
        if ( parent_sel === undefined ) {
          parent_sel = "#calendarSpace";
        }
        var item_box = showItemBox( item, "appointment", parent_sel );
      }
      function showContactBox(item, parent_sel) {
        if ( parent_sel === undefined ) {
          parent_sel = "#contactSpace";
        }
        var item_box = showItemBox( item, "person", parent_sel );
        if ( item.hasOwnProperty("email") ) {
          addMultiLineField(item_box, "Email Addresses", item.email);
        }
        if ( item.hasOwnProperty("phone") ) {
          addMultiLineField(item_box, "Phone Numbers", item.phone);
        }
      }
      function showIdeaBox(item, parent_sel) {
        if ( parent_sel === undefined ) {
          parent_sel = "#ideaSpace";
        }
        var item_box = showItemBox( item, "idea", parent_sel );
      }
      function showNoteBox(item, parent_sel) {
        if ( parent_sel === undefined ) {
          parent_sel = "#noteSpace";
        }
        var item_box = showItemBox( item, "note", parent_sel );
      }
      function showAsAncestor(item) {
        var item_type = item["%TYPE"];
        var parent_sel;
        switch ( item_type ) {
          case "project":
            parent_sel = "#ancProjectSpace";
            break;
          case "appointment":
            parent_sel = "#ancCalendarSpace";
            break;
          case "event":
            parent_sel = "#ancCalendarSpace";
            break;
          default:
            parent_sel = null;
        }
        if ( parent_sel ) {
        }
      }

      function showToDo() {
        $( ".DisplaySpace" ).addClass("Hidden");
        $( "#main_display" ).removeClass("Overview");
        $( "#toDoSpace" ).removeClass("Hidden");
        $( "#top_nav a" ).removeClass("Selected");
        $( "#toDoTab" ).addClass("Selected");
      }
      function showCalendar() {
        $( ".DisplaySpace" ).addClass("Hidden");
        $( "#main_display" ).removeClass("Overview");
        $( "#calendarSpace" ).removeClass("Hidden");
        $( "#top_nav a" ).removeClass("Selected");
        $( "#calendarTab" ).addClass("Selected");
      }
      function showProjects() {
        $( ".DisplaySpace" ).addClass("Hidden");
        $( "#main_display" ).removeClass("Overview");
        $( "#projectSpace" ).removeClass("Hidden");
        $( "#top_nav a" ).removeClass("Selected");
        $( "#projectTab" ).addClass("Selected");
      }
      function showContacts() {
        $( ".DisplaySpace" ).addClass("Hidden");
        $( "#main_display" ).removeClass("Overview");
        $( "#contactSpace" ).removeClass("Hidden");
        $( "#top_nav a" ).removeClass("Selected");
        $( "#selectedTab" ).addClass("Selected");
      }
      function showIdeas() {
        $( ".DisplaySpace" ).addClass("Hidden");
        $( "#main_display" ).removeClass("Overview");
        $( "#ideaSpace" ).removeClass("Hidden");
        $( "#top_nav a" ).removeClass("Selected");
        $( "#ideaTab" ).addClass("Selected");
      }
      function showNotes() {
        $( ".DisplaySpace" ).addClass("Hidden");
        $( "#main_display" ).removeClass("Overview");
        $( "#noteSpace" ).removeClass("Hidden");
        $( "#top_nav a" ).removeClass("Selected");
        $( "#noteTab" ).addClass("Selected");
      }
      function showOverview() {
        $( "#main_display" ).addClass("Overview");
        $( "#main_display > div.DisplaySpace" ).removeClass("Hidden");
        $( "#top_nav a" ).removeClass("Selected");
        $( "#overviewTab" ).addClass("Selected");
      }
      function newAction() {
        alert("newAction");
      }
      function newEvent() {
        alert("newEvent");
      }
      function newAppointment() {
        alert("newAppointment");
      }
      function newProject() {
        alert("newProject");
      }
      function newContact() {
        alert("newContact");
      }
      function newIdea() {
        alert("newIdea");
      }
      function newNote() {
        alert("newNote");
      }
      var test_projects = [{
        "%TYPE": "project",
        "%ID": "breed-mutant-seahorses",
        "%LABEL": "title",
        "title": "Breed Mutant Seahorses",
        "deadline": "2014-03-28T17:00:00",
        "contacts": "jane-morgan",
        "steps": ["build-tank", "catch-seahorses", "assign-to-tanks"] 
      }];
      var test_actions = [{
        "%TYPE": "action",
        "%ID": "build-tank",
        "%LABEL": "content",
        "content": "Build tank for seahorses",
        "context": ["lab"] 
      },
      {
        "%TYPE": "action",
        "%ID": "catch-seahorses",
        "%LABEL": "content",
        "content": "Catch us some seahorses",
        "context": ["atlantic","pacific","indian"] 
      },
      {
        "%TYPE": "action",
        "%ID": "assign-to-tanks",
        "%LABEL": "content",
        "content": "Put 'em in da tanks",
        "context": ["lab"] 
      }];
      var test_persons = [{
        "%TYPE": "person",
        "%ID": "jane-morgan",
        "%LABEL": "given-name & surname",
        "given-name": "Jane",
        "surname": "Morgan",
        "email": ["jane-morgan-work-email"] 
      }];
      var test_emails = [{
        "%TYPE": "email-address",
        "%ID": "jane-morgan-work-email",
        "label": "Work",
        "address": "dr.jane.v.morgan@sea-creature-research.com" 
      }];
      
      function loadTestItems() {
      }
      
      $( document ).ready( function() {
        showOverview();
        showProjectBox(test_projects[0]);
        showContactBox(test_persons[0]);
        for ( var i = 0; i < test_actions.length; i++ ) {
          showActionBox( test_actions[i] );
        }
      });
    </script>
  </head>
  <body>
    <table>
      <tr>
        <td id="logobox">
          <img src="/images/oweb-logo80.png" alt="OmegaWeb" />
        </td>
        <td id="header_main">
          <div id="page_title">
            demo/gtd-plus
          </div>
          <div id="top_nav">
            <a id="overviewTab" class="displayTab" href="#" onclick="showOverview();">Overview</a><!--
            --><a id="toDoTab" class="displayTab" href="#" onclick="showToDo();">ToDo</a><!--
            --><a id="calendarTab" class="displayTab" href="#" onclick="showCalendar();">Calendar</a><!--
            --><a id="projectTab" class="displayTab" href="#" onclick="showProjects();">Projects</a><!--
            --><a id="contactTab" class="displayTab" href="#" onclick="showContacts();">Contacts</a><!--
            --><a id="ideaTab" class="displayTab" href="#" onclick="showIdeas();">Ideas</a><!--
            --><a id="noteTab" class="displayTab" href="#" onclick="showNotes();">Notes</a>
          </div>
        </td>
      </tr>
      <tr>
        <td id="sub_nav">
          <div id="local_menu"></div>
          <div id="quick_menu">
            <a href="#" onclick="newAction();">New Action</a>
            <a href="#" onclick="newEvent();">New Event</a>
            <a href="#" onclick="newAppointment();">New Appointment</a>
            <a href="#" onclick="newProject();">New Project</a>
            <a href="#" onclick="newContact();">New Contact</a>
            <a href="#" onclick="newIdea();">New Idea</a>
            <a href="#" onclick="newNote();">New Note</a>
          </div>
        </td>
        <td id="main_display">
          <div id="ancestorFrame" class="DisplaySpace Hidden">
            <div id="ancProjectSpace" class="DisplaySpace Hidden">
              <h3>PROJECTS</h3>
              &#xA0;
            </div>
            <div id="ancCalendarSpace" class="DisplaySpace Hidden">
              <h3>CALENDAR</h3>
              &#xA0;
            </div>
          </div>
          <div id="toDoSpace" class="DisplaySpace">
            <h3>TO DO</h3>
            &#xA0;
          </div>
          <div id="calendarSpace" class="DisplaySpace">
            <h3>CALENDAR</h3>
            &#xA0;
          </div>
          <div id="projectSpace" class="DisplaySpace">
            <h3>PROJECTS</h3>
            &#xA0;
          </div>
          <div id="contactSpace" class="DisplaySpace">
            <h3>CONTACTS</h3>
            &#xA0;
          </div>
          <div id="ideaSpace" class="DisplaySpace">
            <h3>IDEAS</h3>
            &#xA0;
          </div>
          <div id="noteSpace" class="DisplaySpace">
            <h3>NOTES</h3>
            &#xA0;
          </div>
          <div id="descendantFrame" class="DisplaySpace Hidden">
            <div id="desToDoSpace" class="DisplaySpace Hidden">
              <h3>TO DO</h3>
              &#xA0;
            </div>
            <div id="desCalendarSpace" class="DisplaySpace Hidden">
              <h3>CALENDAR</h3>
              &#xA0;
            </div>
            <div id="desContactSpace" class="DisplaySpace Hidden">
              <h3>CONTACTS</h3>
              &#xA0;
            </div>
            <div id="desIdeaSpace" class="DisplaySpace Hidden">
              <h3>IDEAS</h3>
              &#xA0;
            </div>
            <div id="desNoteSpace" class="DisplaySpace Hidden">
              <h3>NOTES</h3>
              &#xA0;
            </div>
          </div>
        </td>
      </tr>
    </table>
    <div id="footer">
  
    </div>
  </body>
</html>
